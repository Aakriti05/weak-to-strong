Identity added: /nfshomes/anirudhs/.ssh/id_ecdsa (anirudhs@nexuscml00.umiacs.umd.edu)
Identity added: /nfshomes/anirudhs/.ssh/id_ed25519 (anirudh.satheesh@gmail.com)
Thu Mar 7 23:03:58 2024 +---------------------------------------------------------------------------------------+ | NVIDIA-SMI 535.129.03 Driver Version: 535.129.03 CUDA Version: 12.2 | |-----------------------------------------+----------------------+----------------------+ | GPU Name Persistence-M | Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap | Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |=========================================+======================+======================| | 0 NVIDIA RTX A6000 Off | 00000000:C1:00.0 Off | Off | | 30% 32C P8 22W / 300W | 2MiB / 49140MiB | 0% Default | | | | N/A | +-----------------------------------------+----------------------+----------------------+ +---------------------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=======================================================================================| | No running processes found | +---------------------------------------------------------------------------------------+
/cmlscratch/anirudhs/miniconda/bin/python
/cmlscratch/anirudhs/miniconda/envs/w2s/bin/python
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
batch size:  32
<class 'datasets.arrow_dataset.Dataset'>
Warning sciq has less than 2000 docs, using all: Index 1999 out of range for dataset of size 1000.
<class 'datasets.arrow_dataset.Dataset'>
len(train1): 10000 len(train2): 10000 len(test): 1000
Training weak model, size gpt2-large
LR 1e-05 batch_size 32 minibatch_size 8
Accuracy: 0.508 +/- 0.015809364313595916
Step: 0/625 Recent losses: 0.6931471824645996 0.59375 1
Step: 10/625 Recent losses: 0.6938420355319976 0.4875 10
Step: 20/625 Recent losses: 0.6926013588905334 0.51875 10
Step: 30/625 Recent losses: 0.6906512558460236 0.575 10
Step: 40/625 Recent losses: 0.687576025724411 0.534375 10
Step: 50/625 Recent losses: 0.6816853523254395 0.575 10
Step: 60/625 Recent losses: 0.681641447544098 0.59375 10
Step: 70/625 Recent losses: 0.6631076216697693 0.653125 10
Step: 80/625 Recent losses: 0.6588869154453277 0.640625 10
Step: 90/625 Recent losses: 0.6356972754001617 0.678125 10
Step: 100/625 Recent losses: 0.6066622495651245 0.7125 10
Step: 110/625 Recent losses: 0.6406554102897644 0.65 10
Step: 120/625 Recent losses: 0.6370432555675507 0.675 10
Step: 130/625 Recent losses: 0.6480003952980041 0.646875 10
Step: 140/625 Recent losses: 0.6588455438613892 0.6125 10
Step: 150/625 Recent losses: 0.6187433004379272 0.68125 10
Step: 160/625 Recent losses: 0.5870365262031555 0.725 10
Step: 170/625 Recent losses: 0.6079652696847916 0.675 10
Step: 180/625 Recent losses: 0.5881726801395416 0.7125 10
Step: 190/625 Recent losses: 0.6140259563922882 0.678125 10
Step: 200/625 Recent losses: 0.6057931840419769 0.684375 10
Step: 210/625 Recent losses: 0.5950161993503571 0.703125 10
Step: 220/625 Recent losses: 0.6369076609611511 0.6375 10
Step: 230/625 Recent losses: 0.5906805276870728 0.70625 10
Step: 240/625 Recent losses: 0.582951283454895 0.709375 10
Step: 250/625 Recent losses: 0.5724081128835679 0.703125 10
Step: 260/625 Recent losses: 0.5988787561655045 0.6625 10
Step: 270/625 Recent losses: 0.5611083805561066 0.70625 10
Step: 280/625 Recent losses: 0.5891965448856353 0.69375 10
Step: 290/625 Recent losses: 0.5869115352630615 0.721875 10
Step: 300/625 Recent losses: 0.5477543413639069 0.7375 10
Step: 310/625 Recent losses: 0.5656659066677093 0.725 10
Step: 320/625 Recent losses: 0.5626297473907471 0.721875 10
Step: 330/625 Recent losses: 0.5286135017871857 0.728125 10
Step: 340/625 Recent losses: 0.4713666707277298 0.803125 10
Step: 350/625 Recent losses: 0.43573165237903594 0.8125 10
Step: 360/625 Recent losses: 0.45189522206783295 0.809375 10
Step: 370/625 Recent losses: 0.3315546214580536 0.903125 10
Step: 380/625 Recent losses: 0.3663114681839943 0.86875 10
Step: 390/625 Recent losses: 0.37979148924350736 0.8625 10
Step: 400/625 Recent losses: 0.34728417843580245 0.875 10
Step: 410/625 Recent losses: 0.3303257688879967 0.86875 10
Step: 420/625 Recent losses: 0.42197052389383316 0.825 10
Step: 430/625 Recent losses: 0.4636363983154297 0.790625 10
Step: 440/625 Recent losses: 0.42878707945346833 0.815625 10
Step: 450/625 Recent losses: 0.4706922501325607 0.775 10
Step: 460/625 Recent losses: 0.4151124894618988 0.840625 10
Step: 470/625 Recent losses: 0.3726770982146263 0.840625 10
Step: 480/625 Recent losses: 0.3673898816108704 0.853125 10
Step: 490/625 Recent losses: 0.38306314051151275 0.84375 10
Step: 500/625 Recent losses: 0.38944244384765625 0.8625 10
Step: 510/625 Recent losses: 0.42479918003082273 0.83125 10
Step: 520/625 Recent losses: 0.3633538007736206 0.85 10
Step: 530/625 Recent losses: 0.3626777932047844 0.859375 10
Step: 540/625 Recent losses: 0.4275174021720886 0.825 10
Step: 550/625 Recent losses: 0.34886305034160614 0.85625 10
Step: 560/625 Recent losses: 0.35374953746795657 0.865625 10
Step: 570/625 Recent losses: 0.33832248151302335 0.86875 10
Step: 580/625 Recent losses: 0.35520042330026624 0.859375 10
Step: 590/625 Recent losses: 0.34877555817365646 0.8625 10
Step: 600/625 Recent losses: 0.34455468952655793 0.875 10
Step: 610/625 Recent losses: 0.32764198035001757 0.88125 10
Step: 620/625 Recent losses: 0.30779099464416504 0.903125 10
Final evaluation:
Accuracy: 0.724 +/- 0.014135911714495105
Model training took 333.4678919315338 seconds
saved ./results/weak_model_gt/10000/gpt2-large0
Accuracy: 0.8991 +/- 0.0030119626491708035
torch.cuda.memory_allocated: 3.01GB
weak acc: 0.724
Saving the dataset (0/1 shards):   0%|          | 0/10000 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 10000/10000 [00:00<00:00, 81270.31 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 10000/10000 [00:00<00:00, 80850.94 examples/s]
Saving the dataset (0/1 shards):   0%|          | 0/10000 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 10000/10000 [00:00<00:00, 103079.73 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 10000/10000 [00:00<00:00, 102453.78 examples/s]
Saving the dataset (0/1 shards):   0%|          | 0/1000 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 1000/1000 [00:00<00:00, 65501.20 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 1000/1000 [00:00<00:00, 63171.03 examples/s]
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
batch size: 32 E:  1
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   6%|▌         | 582/10000 [00:00<00:01, 5739.49 examples/s]Map:  14%|█▍        | 1410/10000 [00:00<00:01, 5582.26 examples/s]Map:  21%|██        | 2064/10000 [00:00<00:02, 3869.75 examples/s]Map:  28%|██▊       | 2767/10000 [00:00<00:01, 4710.37 examples/s]Map:  33%|███▎      | 3341/10000 [00:00<00:01, 4975.20 examples/s]Map:  40%|████      | 4000/10000 [00:00<00:01, 5284.07 examples/s]Map:  47%|████▋     | 4706/10000 [00:00<00:00, 5780.15 examples/s]Map:  53%|█████▎    | 5344/10000 [00:01<00:00, 5787.25 examples/s]Map:  60%|██████    | 6000/10000 [00:01<00:00, 5888.80 examples/s]Map:  67%|██████▋   | 6711/10000 [00:01<00:00, 6235.63 examples/s]Map:  74%|███████▎  | 7353/10000 [00:01<00:00, 6140.75 examples/s]Map:  80%|████████  | 8000/10000 [00:01<00:00, 5059.15 examples/s]Map:  87%|████████▋ | 8700/10000 [00:01<00:00, 5542.14 examples/s]Map:  93%|█████████▎| 9345/10000 [00:01<00:00, 5657.11 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5765.17 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5283.10 examples/s]
Filter:   0%|          | 0/10000 [00:00<?, ? examples/s]Filter:  80%|████████  | 8000/10000 [00:00<00:00, 64666.66 examples/s]Filter: 100%|██████████| 10000/10000 [00:00<00:00, 61824.23 examples/s]
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
Traceback (most recent call last):
  File "/nfshomes/anirudhs/weak-to-strong/./ada_generate_weight.py", line 301, in <module>
    main()
  File "/nfshomes/anirudhs/weak-to-strong/./ada_generate_weight.py", line 276, in main
    result = pickle.load(open(os.path.join(save_path, "results.pkl"), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: './results/weak_model_gt/10000/gpt2-medium0/results.pkl'
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
batch size: 32 E:  1
Traceback (most recent call last):
  File "/nfshomes/anirudhs/weak-to-strong/ada_train_weak_weight.py", line 341, in <module>
    main()
  File "/nfshomes/anirudhs/weak-to-strong/ada_train_weak_weight.py", line 230, in main
    train1_ds = load_from_disk(train1_name)
  File "/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/datasets/load.py", line 2663, in load_from_disk
    raise FileNotFoundError(f"Directory {dataset_path} not found")
FileNotFoundError: Directory ./sciq/adaboost/train1_10000_1/ not found
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
batch size: 32 E:  2
Traceback (most recent call last):
  File "/nfshomes/anirudhs/weak-to-strong/./ada_generate_weight.py", line 301, in <module>
    main()
  File "/nfshomes/anirudhs/weak-to-strong/./ada_generate_weight.py", line 223, in main
    train1_ds = load_from_disk(train1_name)
  File "/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/datasets/load.py", line 2663, in load_from_disk
    raise FileNotFoundError(f"Directory {dataset_path} not found")
FileNotFoundError: Directory ./sciq/adaboost/train1_10000_1/ not found
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
batch size: 32 E:  2
Traceback (most recent call last):
  File "/nfshomes/anirudhs/weak-to-strong/ada_train_weak_weight.py", line 341, in <module>
    main()
  File "/nfshomes/anirudhs/weak-to-strong/ada_train_weak_weight.py", line 230, in main
    train1_ds = load_from_disk(train1_name)
  File "/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/datasets/load.py", line 2663, in load_from_disk
    raise FileNotFoundError(f"Directory {dataset_path} not found")
FileNotFoundError: Directory ./sciq/adaboost/train1_10000_2/ not found
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
Map:   0%|          | 0/1000 [00:00<?, ? examples/s]Map:  62%|██████▏   | 622/1000 [00:00<00:00, 6162.60 examples/s]Map: 100%|██████████| 1000/1000 [00:00<00:00, 5212.57 examples/s]
Filter:   0%|          | 0/1000 [00:00<?, ? examples/s]Filter: 100%|██████████| 1000/1000 [00:00<00:00, 27939.86 examples/s]
train2_ds:  1000
loading from ./results/weak_model_gt/10000/gpt2-large0
2.187264335631164 0.8991
Traceback (most recent call last):
  File "/nfshomes/anirudhs/weak-to-strong/ada_predict.py", line 331, in <module>
    fire.Fire(main)
  File "/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/cmlscratch/anirudhs/miniconda/envs/w2s/lib/python3.9/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/nfshomes/anirudhs/weak-to-strong/ada_predict.py", line 296, in main
    result = pickle.load(open(os.path.join(save_path, "results.pkl"), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: './results/weak_model_gt/10000/gpt2-large1/results.pkl'
